=== COMPREHENSIVE DATA PROCESSOR WORKFLOW TEST ===

PASS: Data_Processor_r0 imported successfully
Using 4 test files: ['2024-04-17 Data.csv', '2025-07-15 Data.csv', '2025-07-16 Data.csv', '2025-07-16 Data_Trimmed.csv']
Test output directory: test_workflow_outputs

--- TEST 1: Create App Instance and Setup ---
PASS: App instance created
PASS: Set 2 input files
PASS: Set output directory to test_workflow_outputs
PASS: Loaded signals, found 156 signals
  Sample signals: ['ac_curr', 'ac_pct', 'ac_pow', 'ac_volt', 'bh_cone']

--- TEST 2: Configure Processing Settings ---
PASS: Selected 10 signals for processing
PASS: Configured processing settings
  Filter: Moving Average
  Resample: False
  Export format: CSV (Separate Files)

--- TEST 3: Test Processing Pipeline ---
Processing 10 selected signals
Testing processing of: 2024-04-17 Data.csv

_process_single_file called for: 2024-04-17 Data.csv
  Loading CSV file...
  Loaded DataFrame shape: (86381, 137)
  Original columns: ['local_time', 'scrb_ph', 'co_pct', 'co2_pct', 'ch4_pct', 'h2_pct', 'o2_pct', 'n2_pct', 'c_ratio', 'syn_den', 'psa_fd_d', 'ac_volt', 'dc_volt', 'pct_outp', 'p_ng2_sp', 'p_air1', 'p_natgas', 'p_ng2', 'p_air2', 'pemo2a', 'pemn2a', 'pem_pro', 'pemo2b', 'pemn2b', 'gad_fg', 'gad_o2', 'q_n2', 'q_syn', 'q_wat', 'syn_pph', 'syn_scfm', 'psa_fd_f', 'psa_ave', 'psa_scfm', 'h2_flow', 'h2_avg_f', 'total_n2', 'total_o2', 'omega_o2', 'ac_pct', 'fdr_amp', 'ac_curr', 'dc_curr', 'ac_pow', 'dc_pow', 'scrb_lev', 'p_valve', 'bh_dp', 'p_press', 'pem_p', 'p_o2a_p', 'p_pro_p', 'p_o2b_p', 'g_fg_p', 'g_o2_p', 'q_n2_p', 'q_syn_p', 'q_wat_p', 'scrb_p', 'blw_pr', 'synfm_p', 'cmpr_pr', 'h2_press', 'n2_press', 'o2_press', 'feed_pct', 'cull_pct', 'blw_pct', 'cmpr_pct', 'psa_pct', 'psa_rph', 'p_chmb_t', 'p_hx_in', 'p_hx_out', 'p_out_t', 'pem', 'trc_bot', 'trc_top', 'trc_surf', 'trc_q', 'l_ac_hld', 'r_ac_hld', 'n_dc_cw', 's_dc_cw', 'dr_cwr', 'q_out', 'bh_out', 'bh_surf', 'bh_cone', 'scrbtank', 'scrb_hx', 'blw_hxi', 'blw_hxo', 'synfm_t', 'cmpr_1i', 'cmpr_1o', 'cmpr_2i', 'cmpr_2o', 'cwr', 'cws', 'scale1', 'scale2', 'h2ali_pct', 'utc_time', 'pg_temp', 'pg_p', 'gratecw', 'lil_scale', 'pg_dp', 'boiler', 'steam', 'co2_p', 'co2_t', 'co2_af', 'co2_sf', 'co2_sp', 'co2_vlv', 'co2_tot', 'dc_mtr', 'dc_mtr2', 'big_scale', 'new_n2', 'flash_t1', 'flash_t2', 'flash_t3', 'flash_t4', 'flash_t5', 'flash_p1', 'flash_p2', 'flash_l1', 'flash_f1', 'flash_v1', 'flash_v2', 'flash_v3', 'naoh_pct', 'out_scale', 'omega_pro']
  Time column: local_time
  Signals found in file: 10
  Added time column to signals
  Final signals to process: ['local_time', 'ac_curr', 'ac_pct', 'ac_pow', 'ac_volt', 'bh_cone', 'bh_dp', 'bh_out', 'bh_surf', 'big_scale', 'blw_hxi']
  Copied DataFrame shape: (86381, 11)
  Converting data types...
  Dropped 0 rows with invalid time
  Column ac_curr: 86381 -> 86381 valid values
  Column ac_pct: 86381 -> 86381 valid values
  Column ac_pow: 86381 -> 86381 valid values
  Column ac_volt: 86381 -> 86381 valid values
  Column bh_cone: 86381 -> 86381 valid values
  Column bh_dp: 86381 -> 86381 valid values
  Column bh_out: 86381 -> 86381 valid values
  Column bh_surf: 86381 -> 86381 valid values
  Column big_scale: 86381 -> 86381 valid values
  Column blw_hxi: 86381 -> 86381 valid values
  Setting time column as index...
  DataFrame shape after indexing: (86381, 10)
  Filter type: Moving Average
  Applying filtering...
  Numeric columns for filtering: ['ac_curr', 'ac_pct', 'ac_pow', 'ac_volt', 'bh_cone', 'bh_dp', 'bh_out', 'bh_surf', 'big_scale', 'blw_hxi']
  Resampling disabled
  Resetting index...
  DataFrame shape after reset: (86381, 11)
  Applying custom variables...
  DataFrame shape after custom vars: (86381, 11)
  SUCCESS: Returning processed DataFrame with shape (86381, 11)
PASS: File processing successful
  Original file shape: 137 columns
  Processed shape: (86381, 11)
  Processing preserved 10 selected signals
PASS: Stored processed data for plotting

--- TEST 4: Test Export Functionality ---
_export_csv_separate called with 1 files
Exporting to: test_workflow_outputs\2024-04-17 Data_processed.csv
Final export path: test_workflow_outputs\2024-04-17 Data_processed.csv
Successfully exported: test_workflow_outputs\2024-04-17 Data_processed.csv
Export summary: 1 files exported
Showing success message for 1 files
PASS: CSV export successful, created 1 files
  Created: 2024-04-17 Data_processed.csv (9383128 bytes)
PASS: Excel export successful, created 1 files

--- TEST 5: Test Plotting Functionality ---
Testing plotting with data from: 2024-04-17 Data.csv
Available columns for plotting: ['local_time', 'ac_curr', 'ac_pct', 'ac_pow', 'ac_volt', 'bh_cone', 'bh_dp', 'bh_out', 'bh_surf', 'big_scale', 'blw_hxi']
PASS: Plotting data ready
  Time column: local_time
  Signal columns: 10 available
  Sample signals: ['ac_curr', 'ac_pct', 'ac_pow']
PASS: Plot data prepared, shape: (86381, 4)

--- TEST 6: Integration and Differentiation Features ---
PASS: Integration test successful
  Created cumulative column for: ac_curr
PASS: Differentiation test successful
  Created derivative column for: ac_curr

--- TEST 7: Custom Variables Feature ---
PASS: Custom variables defined: 2 variables
  TestSum: [Signal1] + [Signal2]
  TestRatio: [Signal1] / [Signal2]
PASS: Custom variables display updated

PASS: App cleanup successful

=== WORKFLOW TEST SUMMARY ===
Comprehensive workflow test completed!
Test outputs are in: test_workflow_outputs

Created 2 output files:
  2024-04-17 Data_processed.csv (9383128 bytes)
  2024-04-17 Data_processed.xlsx (4486423 bytes)

=== FUNCTIONALITY VERIFIED ===
Traceback (most recent call last):
  File "C:\Users\diete\Tools\data_processor\test_workflow.py", line 312, in <module>
    print("\u2713 Data loading and processing")
  File "C:\ProgramData\Anaconda3\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u2713' in position 0: character maps to <undefined>
